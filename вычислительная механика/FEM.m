%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%??????? ??????
l1=2
l2=1
E=2*10^11 
I= 350*10^(-8) 
Wx= 58.4*10^(-6) 
SigmaT=300*10^6
c=70000; 
M=9000; 
%??????????? ??????? ?????????
K1=E*I*[12/(l1^3)   6/l1^2      -12/l1^3                         6/l1^2                      0           0
        6/l1^2     4/l1       -6/l1^2                             2/l1                       0           0
        -12/l1^3   -6/l1^2   (12/l1^3+12/l2^3)            (-6/l1^2+6/l2^2)                 -12/l2^3     6/l2^2            
        6/l1^2     2/l1          (-6/l1^2+6/l2^2)              (4/l1+4/l2)                  -6/l2^2     2/l2 
        0             0           -12/l2^3                         -6/l2^2                  c+12/l2^3   -6/l2^2
        0             0             6/l2^2                           2/l2                    6/l2^2      4/l2]

       
  
                  
                  
K2=K1;
K2([1 3 6], : ) = 0;
K2(:,[1 3 6] ) = 0;
K2(1,1)=K1(1,1);
K2(3,3)=K1(3,3);
K2(6,6)=K1(6,6);
%С??????? ??????
R=[0; 0; 0; M;0;0;]
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%?????????? ???????????
u2=K2\R
eig(K1)
eig(K2)
Znac = [0.0000 -0.0054 0.0030 0.0324 0.0638 4.9861;0.0008 0.0105 0.0105 0.0177  0.0280 4.9844];
fid=fopen('b.txt','wt');
fprintf(fid,'%6.4f %6.4f\n', Znac);
fclose(fid);
fid=fopen('b.txt','rt');
A=fscanf(fid,'%f',[2 8]) ;
fclose(fid);

Kcb=K1;
Kcb([1 3 5 6], : ) = 0;
Kcb(:,[1 3 5 6] ) = 0;
Kcb(1,1)=K1(1,1);
Kcb(3,3)=K1(3,3);
Kcb(6,6)=K1(6,6);
Kcb(5,5)=K1(5,5);
Ucb=Kcb\R;
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%?????????? ????????
figure(1)
hold on; grid on
ylabel('W(x)')
xlabel('x')
x1=[0:0.01:l1];
x2=[0:0.01:l2];
x2i=[l1:0.01:l2+l1];
x=x1;

N11=1-3*x.^2./l1^2+2*x.^3./l1^3;
N21=x-2*x.^2./l1+x.^3./l1^2;
N31=3*x.^2./l1^2-2*x.^3./l1^3;
N41=-x.^2./l1+x.^3./l1^2;
x=x2;
N12=1-3*x.^2./l2^2+2*x.^3./l2^3;
N22=x-2*x.^2./l2+x.^3./l2^2;
N32=3*x.^2./l2^2-2*x.^3./l2^3;
N42=-x.^2./l2+x.^3./l2^2;
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
Wcb1=N11*Ucb(1)+N21*Ucb(2)+N31*Ucb(3)+N41*Ucb(4);
Wcb2=N12*Ucb(3)+N22*Ucb(4)+N32*Ucb(5)+N42*Ucb(6);  
plot(x1,Wcb1,x2i,Wcb2)

ucb1=[Ucb(1); Ucb(2); Ucb(3); Ucb(4)];  
ucb2=[Ucb(3); Ucb(4); Ucb(5); Ucb(6)];  


k1= E*I*[12/l1^3   6/l1^2       -12/l1^3           6/l1^2                      
        6/l1^2     4/l1           -6/l1^2            2/l1 
        
       -12/l1^3   -6/l1^2       12/l1^3           -6/l1^2 
      6/l1^2       2/l1          -6/l1^2            4/l1];
 
k2= E*I*[12/l2^3   6/l2^2       -12/l2^3           6/l2^2                      
        6/l2^2     4/l2          -6/l2^2            2/l2                       
        -12/l2^3   -6/l2^2       12/l2^3           -6/12^2 
      6/l2^2        2/l2          -6/l2^2            4/l2];

               
rcb1=k1*ucb1
rcb2=k2*ucb2
X=[0 2 2 3]
figure(2)
hold on; grid on
ylabel('Mx(x)')
xlabel('x')
Mxcb=[-rcb1(2);rcb1(4);-rcb2(2);rcb2(4)]  
plot(X,Mxcb)
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
figure(3)
hold on; grid on
c=0;
ylabel('W(x)')
xlabel('x')
%составим матрицу жесткости для c=0
Kc0=E*I*[12/l1^3   6/l1^2   -12/l1^3                                  6/l1^2                      0           0
                     6/l1^2     4/l1       -6/l1^2                                      2/l1                       0           0
                  -12/l1^3   -6/l1^2   (12/l1^3+12/l2^3)            (-6/11^2+6/12^2)   -12/l2^3   6/l2^2            
                   6/l1^2     2/l1          (-6/11^2+6/12^2)              (4/11+4/12)            -6/l2^2     2/l2 
                      0              0           -12/l2^3                         -6/l2^2                      c+12/l2^3   -6/l2^2
                      0              0             6/l2^2                            2/l2                            -6/l2^2      4/l2]
Kc0([1 3 6], : ) = 0;
Kc0(:,[1 3 6] ) = 0;
Kc0(1,1)=K1(1,1);
Kc0(3,3)=K1(3,3);
Kc0(6,6)=K1(6,6);
Uc0=Kc0\R
x1=[0:0.01:l1];
x2=[0:0.01:l2];
x2i=[l1:0.01:l2+l1];
x=x1;
N11=1-3*x.^2./l1^2+2*x.^3./l1^3;
N21=x-2*x.^2./l1+x.^3./l1^2;
N31=3*x.^2./l1^2-2*x.^3./l1^3;
N41=-x.^2./l1+x.^3./l1^2;
x=x2;
N12=1-3*x.^2./l2^2+2*x.^3./l2^3;
N22=x-2*x.^2./l2+x.^3./l2^2;
N32=3*x.^2./l2^2-2*x.^3./l2^3;
N42=-x.^2./l2+x.^3./l2^2;
Wc01=N11*Uc0(1)+N21*Uc0(2)+N31*Uc0(3)+N41*Uc0(4);
Wc02=N12*Uc0(3)+N22*Uc0(4)+N32*Uc0(5)+N42*Uc0(6);  
plot(x1,Wc01,x2i,Wc02);
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%Составим вектора перемещений
uc01=[Uc0(1); Uc0(2); Uc0(3); Uc0(4)];   
uc02=[Uc0(3); Uc0(4); Uc0(5); Uc0(6)];  
%определим реакции
rc01=k1*uc01    
rc02=k2*uc02  
Mxc0=[-rc01(2);rc01(4);-rc02(2);rc02(4)]  
figure(4)
hold on; grid on
ylabel('Mx(x)')
xlabel('x')
plot(X,Mxc0)
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
R0=rc01(3)-rc02(1)% реакция опоры
maxMx=max(abs(Mxc0)) %найдем максимальный момент
maxSigma=maxMx/Wx

n=SigmaT/maxSigma


